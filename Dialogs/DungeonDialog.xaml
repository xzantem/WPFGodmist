<Window x:Class="GodmistWPF.Dialogs.DungeonDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:controls="clr-namespace:GodmistWPF.Controls"
        Title="Dungeon Exploration" Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Loaded="Window_Loaded"
        Unloaded="Window_Unloaded"
        Closing="Window_Closing"
        WindowStyle="ToolWindow">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Quest Completed Overlay (spans all rows) -->
        <controls:QuestCompletedOverlay x:Name="QuestCompletedOverlay" 
                                      Grid.Row="0"
                                      Grid.RowSpan="3"
                                      Panel.ZIndex="1000"/>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="10">
            <StackPanel Orientation="Horizontal">
                <TextBlock x:Name="DungeonName" Text="Dungeon: " Foreground="White" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
                <TextBlock x:Name="FloorNumber" Text="Floor: 1" Foreground="LightBlue" FontSize="16" Margin="30,0,0,0" VerticalAlignment="Center"/>
                <TextBlock x:Name="RoomNumber" Text="Location: 1" Foreground="LightBlue" FontSize="16" Margin="30,0,0,0" VerticalAlignment="Center"/>
                <TextBlock x:Name="DungeonType" Text="Type: " Foreground="LightGreen" FontSize="16" Margin="30,0,0,0" VerticalAlignment="Center"/>
                <TextBlock x:Name="Difficulty" Text="Level: 1" Foreground="Yellow" FontSize="16" Margin="30,0,0,0" VerticalAlignment="Center"/>
                
            </StackPanel>
        </Border>
        
        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel: Player & Actions -->
            <Border Grid.Column="0" Background="#34495E" Margin="5" Padding="10">
                <StackPanel>
                    <TextBlock Text="Player" Foreground="White" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                    <TextBlock x:Name="PlayerName" Text="Name" Foreground="White" FontWeight="Bold"/>
                    <TextBlock x:Name="PlayerLevel" Text="Level: 1" Foreground="LightBlue"/>
                    <TextBlock x:Name="PlayerHealth" Text="HP: 100/100" Foreground="LightGreen"/>
                    <TextBlock x:Name="PlayerResource" Text="MP: 50/50" Foreground="LightCyan"/>
                    <TextBlock x:Name="PlayerGold" Text="Gold: 100" Foreground="Yellow"/>
                    <TextBlock x:Name="PlayerAttack" Text="Attack: 10-15" Foreground="Orange"/>
                    <TextBlock x:Name="PlayerDefense" Text="Defense: 5/5" Foreground="LightGray"/>
                    <TextBlock x:Name="PlayerSpeed" Text="Speed: 10" Foreground="Yellow"/>
                    <Separator Margin="0,10,0,10"/>
                    <TextBlock Text="Actions" Foreground="White" FontSize="14" FontWeight="Bold" Margin="0,0,0,5"/>
                    <StackPanel x:Name="ActionButtonsPanel">
                        <Button x:Name="MoveForwardButton" Content="Move Forward" Background="#27AE60" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="MoveForwardButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="DescendButton" Content="Descend Floor" Background="#34495E" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="DescendButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="MoveBackButton" Content="Move Back" Background="#2980B9" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="MoveBackButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="AscendButton" Content="Ascend Floor" Background="#34495E" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="AscendButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="ExitDungeonButton" Content="Exit Dungeon" Background="#E74C3C" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="ExitDungeonButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="RestBonfireButton" Content="Rest at Bonfire" Background="#E67E22" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="RestBonfireButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="CollectPlantButton" Content="Collect Plant" Background="#16A085" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="CollectPlantButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="OpenStashButton" Content="Open Stash" Background="#8E44AD" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="OpenStashButton_Click" Visibility="Collapsed"/>
                        <Button x:Name="DisarmTrapButton" Content="Disarm Trap" Background="#C0392B" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="DisarmTrapButton_Click" Visibility="Collapsed"/>
                        <Separator x:Name="PermanentButtonsSeparator" Margin="0,10,0,10" Visibility="Collapsed"/>
                        <Button x:Name="OpenInventoryButton" Content="Inventory" Background="#2C3E50" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="OpenInventoryButton_Click"/>
                        <Button x:Name="OpenCharacterButton" Content="Character" Background="#2C3E50" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="OpenCharacterButton_Click"/>
                        <Button x:Name="OpenQuestLogButton" Content="Quest Log" Background="#2C3E50" Foreground="White" Padding="10,5" Margin="0,0,0,5" Click="OpenQuestLogButton_Click"/>
                    </StackPanel>
                </StackPanel>
            </Border>
            
            <!-- Right Panel: Map & Log -->
            <Grid Grid.Column="1" Margin="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <!-- Minimap / Map -->
                <Border Grid.Row="0" Background="#22313F" Margin="5" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Dungeon Map" Foreground="White" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                        <ScrollViewer x:Name="MapScroll" 
                                    VerticalScrollBarVisibility="Auto" 
                                    HorizontalScrollBarVisibility="Auto"
                                    Padding="5">
                            <ItemsControl x:Name="MapDisplay" 
                                        ItemsSource="{Binding}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal" 
                                                 ItemWidth="80"
                                                 ItemHeight="60"
                                                 VerticalAlignment="Center"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border x:Name="RoomBorder"
                                                Width="70"
                                                Height="50"
                                                Margin="2"
                                                BorderThickness="1"
                                                BorderBrush="#4A90E2"
                                                CornerRadius="4"
                                                Background="{Binding BackgroundColor}">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsCurrent}" Value="True">
                                                            <Setter Property="BorderThickness" Value="2"/>
                                                            <Setter Property="BorderBrush" Value="#FFD700"/>
                                                            <Setter Property="Effect">
                                                                <Setter.Value>
                                                                    <DropShadowEffect BlurRadius="10" 
                                                                                    Opacity="0.8" 
                                                                                    ShadowDepth="0"
                                                                                    Color="#FFD700"/>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Grid>
                                                <TextBlock Text="{Binding DisplayText}" 
                                                         FontWeight="SemiBold"
                                                         FontSize="{Binding FontSize}"
                                                         Foreground="White"
                                                         TextWrapping="Wrap"
                                                         TextAlignment="Center"
                                                         HorizontalAlignment="Center"
                                                         VerticalAlignment="Center"
                                                         Margin="2"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </StackPanel>
                </Border>
                <!-- Dungeon Log -->
                <Border Grid.Row="1" Background="#22313F" Margin="5" Padding="10">
                    <StackPanel>
                        <TextBlock Text="Dungeon Log" Foreground="White" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                        <ScrollViewer x:Name="DungeonLogScroll" Height="300" VerticalScrollBarVisibility="Auto">
                            <TextBlock x:Name="DungeonLog" Foreground="White" TextWrapping="Wrap" FontFamily="Consolas"/>
                        </ScrollViewer>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
        
        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#2C3E50" Padding="10">
            <TextBlock x:Name="StatusText" Text="Exploring the dungeon..." Foreground="White" FontSize="12"/>
        </Border>
    </Grid>
</Window> 